# üé¨ GUI√ìN: Generaci√≥n de Tests Autom√°ticos con IA

**Duraci√≥n: 30 minutos**

## üéØ **OBJETIVOS DEL VIDEO**

- Generar tests unitarios e integraci√≥n
- Cubrir casos comunes y extremos
- Refactorizar tests antiguos
- Explicar cobertura de pruebas generada por IA

---

## ‚è±Ô∏è **ESTRUCTURA TEMPORAL**

### **INTRODUCCI√ìN DEL M√ìDULO (0:00 - 8:00)**

#### **[0:00 - 0:30] Presentaci√≥n**

```
¬°Hola! Soy [Nombre] y en este video vamos a aprender c√≥mo generar
tests autom√°ticos usando IA para nuestro sistema CRUD.

Antes de empezar con la pr√°ctica, vamos a establecer los fundamentos
te√≥ricos con unas presentaciones interactivas que he preparado.
```

#### **[0:30 - 5:00] Fundamentos Te√≥ricos con Presentaciones**

**üé¨ ACCIONES EN PANTALLA:**

1. **Abrir presentaciones/index.html**
2. **Navegar por cada presentaci√≥n explicando:**

**[0:30 - 1:30] ¬øQu√© es CI/CD?**

```
Primero, entendamos por qu√© necesitamos tests autom√°ticos.
CI/CD es la metodolog√≠a que automatiza todo el proceso:
C√≥digo ‚Üí Tests ‚Üí Build ‚Üí Deploy

Los tests son fundamentales para:
- Confianza en el c√≥digo
- Refactoring seguro
- Detecci√≥n temprana de bugs
- Despliegues autom√°ticos seguros
```

**[1:30 - 2:30] Tipos de Tests**

```
Tenemos una pir√°mide de testing:
- Tests Unitarios: Muchos, r√°pidos, espec√≠ficos
- Tests de Integraci√≥n: Algunos, moderados, realistas
- Tests E2E: Pocos, lentos, completos

Hoy nos enfocaremos en unitarios e integraci√≥n.
```

**[2:30 - 3:30] Herramientas**

```
Usaremos el mejor stack para JavaScript:
- Jest: Framework completo con todo incluido
- Supertest: Para testing de APIs HTTP
- Zero configuration, mocks autom√°ticos, cobertura built-in
```

**[3:30 - 4:30] Instalaci√≥n**

```
El setup es s√∫per simple:
npm install --save-dev jest supertest
Y configuraci√≥n m√≠nima en jest.config.js
```

**[4:30 - 5:00] Transici√≥n a la pr√°ctica**

```
Perfecto! Ahora que tenemos la base te√≥rica clara,
vamos a ver nuestro CRUD funcionando y luego crear
todos los tests autom√°ticamente con IA.
```

#### **[5:00 - 8:00] Demo del CRUD Funcionando**

```
Antes de crear los tests, veamos que nuestro CRUD funciona perfectamente.

[MOSTRAR PANTALLA]
- Tenemos nuestro sistema CRUD de usuarios
- Vamos a probarlo en Postman para verificar que funciona
```

**üé¨ ACCIONES EN PANTALLA:**

1. **Abrir terminal y ejecutar servidor:**

   ```bash
   npm start
   ```

2. **Abrir Postman y probar endpoints:**

   **POST /api/users (Crear usuario):**

   ```json
   {
     "name": "Juan P√©rez",
     "email": "juan@example.com",
     "password": "123456"
   }
   ```

   **GET /api/users (Listar usuarios):**

   ```
   http://localhost:3000/api/users
   ```

   **GET /api/users/stats (Estad√≠sticas):**

   ```
   http://localhost:3000/api/users/stats
   ```

```
Perfecto! El CRUD funciona. Ahora, ¬øc√≥mo nos aseguramos de que siga
funcionando cuando hagamos cambios? ¬°Con tests autom√°ticos!

Ya vimos la teor√≠a, ahora vamos a la pr√°ctica.
```

---

### **PARTE 2: CONFIGURACI√ìN Y ESTRUCTURA (8:00 - 12:00)**

#### **[8:00 - 9:30] Instalaci√≥n y configuraci√≥n**

**üé¨ ACCIONES EN PANTALLA:**

```bash
# Instalar dependencias de testing
npm install --save-dev jest supertest

# Ver package.json actualizado
```

**Mostrar configuraci√≥n de Jest:**

```javascript
// jest.config.js
module.exports = {
  testEnvironment: "node",
  testMatch: ["**/__tests__/**/*.js", "**/?(*.)+(spec|test).js"],
  collectCoverageFrom: [
    "controllers/**/*.js",
    "models/**/*.js",
    "services/**/*.js",
    "middleware/**/*.js",
    "routes/**/*.js",
  ],
  setupFilesAfterEnv: ["<rootDir>/tests/setup.js"],
  testTimeout: 10000,
  verbose: true,
};
```

#### **[9:30 - 11:00] Estructura de carpetas**

```
Vamos a organizar nuestros tests de manera profesional:

tests/
‚îú‚îÄ‚îÄ setup.js              # Configuraci√≥n global
‚îú‚îÄ‚îÄ unit/                  # Tests unitarios
‚îÇ   ‚îú‚îÄ‚îÄ User.test.js      # Tests del modelo
‚îÇ   ‚îî‚îÄ‚îÄ userController.test.js  # Tests del controlador
‚îú‚îÄ‚îÄ integration/           # Tests de integraci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ users.api.test.js # Tests de endpoints
‚îî‚îÄ‚îÄ mocks/                # Mocks y fakes
    ‚îî‚îÄ‚îÄ emailService.mock.js
```

**üé¨ ACCIONES EN PANTALLA:**

```bash
# Crear estructura de directorios EN VIVO
mkdir tests
mkdir tests/unit tests/integration tests/mocks

# En Windows PowerShell:
New-Item -ItemType Directory -Path "tests" -Force
New-Item -ItemType Directory -Path "tests\unit" -Force
New-Item -ItemType Directory -Path "tests\integration" -Force
New-Item -ItemType Directory -Path "tests\mocks" -Force
```

**üí° NOTA IMPORTANTE:**

```
Voy a crear la estructura EN VIVO para que veas c√≥mo se hace.
La carpeta tests NO debe existir previamente - la creamos desde cero
para mostrar todo el proceso completo.
```

#### **[11:00 - 12:00] Setup global**

```
El archivo setup.js configura el entorno de testing:
- Variables de entorno para tests
- Mocks de console para tests limpios
- Timeouts globales
```

**Mostrar tests/setup.js:**

```javascript
process.env.NODE_ENV = "test";
process.env.PORT = 3001;
console.log = jest.fn();
console.warn = jest.fn();
jest.setTimeout(10000);
```

---

### **PARTE 3: TESTS UNITARIOS CON IA (12:00 - 18:00)**

#### **[12:00 - 13:30] Generando tests del modelo User**

```
Vamos a usar IA para generar tests del modelo User.
Le voy a pedir que cubra todos los casos posibles.
```

**üé¨ PROMPT PARA IA:**

```
Genera tests unitarios completos para el modelo User que incluyan:
- Constructor y generaci√≥n de IDs
- Validaci√≥n de nombre (vac√≠o, corto, largo, tipo incorrecto)
- Validaci√≥n de email (formatos v√°lidos e inv√°lidos)
- Validaci√≥n de contrase√±a (longitud m√≠nima/m√°xima)
- M√©todos toJSON y toObject
- Repository CRUD completo
- Casos extremos y manejo de errores
```

#### **[13:30 - 15:00] Revisando tests generados**

```
¬°Mira lo que gener√≥ la IA! Tenemos 33 tests que cubren:

CONSTRUCTOR:
‚úì Crear usuario v√°lido
‚úì Generar IDs √∫nicos
‚úì Usar ID personalizado

VALIDACIONES:
‚úì Datos correctos
‚úì Nombre vac√≠o/corto/largo
‚úì Email inv√°lido/v√°lido
‚úì Contrase√±a corta/larga

REPOSITORY:
‚úì Crear/buscar/actualizar/eliminar
‚úì Emails duplicados
‚úì Casos extremos
```

**üé¨ ACCIONES EN PANTALLA:**

```bash
# Ejecutar tests unitarios
npm run test:unit

# Mostrar resultados
```

#### **[15:00 - 16:30] Tests del controlador con mocks**

```
Ahora los tests del controlador. Aqu√≠ necesitamos mocks
porque el controlador usa el servicio de email.

La IA va a generar:
- Mocks del email service
- Tests de todos los endpoints del controlador
- Simulaci√≥n de errores
- Casos con/sin email configurado
```

#### **[16:30 - 18:00] Ejecutando tests unitarios**

```bash
# Ver todos los tests unitarios
npm run test:unit
```

```
¬°Excelente! Tenemos 53 tests unitarios pasando.
La IA gener√≥ tests que cubren:
- Casos exitosos
- Manejo de errores
- Validaciones
- Mocks del email service
- Casos extremos
```

---

### **PARTE 4: TESTS DE INTEGRACI√ìN (18:00 - 23:00)**

#### **[18:00 - 19:30] ¬øQu√© son los tests de integraci√≥n?**

```
Los tests de integraci√≥n prueban toda la cadena:
Request ‚Üí Router ‚Üí Controller ‚Üí Model ‚Üí Response

Ventajas:
- Prueban el flujo completo
- Detectan problemas de integraci√≥n
- M√°s confianza en el sistema

Usamos Supertest para simular requests HTTP reales.
```

#### **[19:30 - 21:00] Generando tests de API**

**üé¨ PROMPT PARA IA:**

```
Genera tests de integraci√≥n completos para la API de usuarios que incluyan:
- Todos los endpoints CRUD (POST, GET, PUT, PATCH, DELETE)
- Endpoint de b√∫squeda por email
- Endpoint de estad√≠sticas
- Casos de √©xito y error
- Validaci√≥n de respuestas JSON
- C√≥digos de estado HTTP correctos
- Casos extremos (caracteres especiales, l√≠mites)
- Manejo de errores del servidor
```

#### **[21:00 - 23:00] Ejecutando tests de integraci√≥n**

```bash
# Ejecutar tests de integraci√≥n
npm run test:integration
```

```
¬°Incre√≠ble! La IA gener√≥ 29 tests de integraci√≥n que cubren:

CRUD COMPLETO:
‚úì POST /api/users - Crear usuarios
‚úì GET /api/users - Listar usuarios
‚úì GET /api/users/:id - Obtener por ID
‚úì PUT/PATCH /api/users/:id - Actualizar
‚úì DELETE /api/users/:id - Eliminar

FUNCIONES ESPECIALES:
‚úì GET /api/users/search/email/:email
‚úì GET /api/users/stats

CASOS EXTREMOS:
‚úì Caracteres especiales en nombres
‚úì Emails con subdominios complejos
‚úì JSON malformado
‚úì IDs inexistentes
```

---

### **PARTE 5: MOCKS Y CASOS EXTREMOS (23:00 - 26:00)**

#### **[23:00 - 24:30] Sistema de mocks avanzado**

```
La IA cre√≥ un sistema de mocks sofisticado para el email service:

CARACTER√çSTICAS:
- Tracking de llamadas
- Simulaci√≥n de diferentes errores
- Configuraci√≥n flexible
- Utilidades para testing
```

**Mostrar emailService.mock.js:**

```javascript
const emailServiceMock = {
  // Simula env√≠o exitoso
  async sendWelcomeEmail(email, userData) { ... },

  // Simula diferentes errores
  simulateNetworkError() { ... },
  simulateAuthError() { ... },
  simulateRateLimitError() { ... },

  // Utilidades para tests
  getCalls() { ... },
  wasCalledWith(method, email) { ... }
};
```

#### **[24:30 - 26:00] Casos extremos importantes**

```
La IA identific√≥ y cubri√≥ casos extremos cruciales:

DATOS EXTREMOS:
‚úì Nombres con acentos y caracteres especiales
‚úì Emails con m√∫ltiples subdominios
‚úì Contrase√±as con s√≠mbolos especiales
‚úì L√≠mites exactos de longitud

ERRORES DEL SISTEMA:
‚úì JSON malformado
‚úì Content-Type incorrecto
‚úì Fallos de base de datos
‚úì Servicios no disponibles

CASOS L√çMITE:
‚úì Strings vac√≠os vs null vs undefined
‚úì IDs que no existen
‚úì Emails duplicados
‚úì Conexiones perdidas
```

---

### **PARTE 6: COBERTURA Y AN√ÅLISIS (26:00 - 29:00)**

#### **[26:00 - 27:30] An√°lisis de cobertura**

```bash
# Generar reporte de cobertura
npm run test:coverage
```

```
¬°Mira estos resultados impresionantes!

COBERTURA TOTAL:
- Modelos: 93.1% ‚≠ê
- Controladores: 90.27% ‚≠ê
- Rutas: 100% üéØ
- Middleware: 76.71% ‚úÖ

M√âTRICAS:
- 82 tests totales
- 76 tests pasando (93%)
- Casos comunes y extremos cubiertos
- Mocks sofisticados implementados
```

#### **[27:30 - 29:00] Beneficios logrados**

```
Con estos tests autom√°ticos generados por IA logramos:

CONFIABILIDAD:
- 93% de tests pasando
- Casos extremos cubiertos
- Mocks realistas

MANTENIBILIDAD:
- Refactoring seguro
- Documentaci√≥n viva
- Detecci√≥n temprana de bugs

PRODUCTIVIDAD:
- 82 tests generados en minutos
- Estructura profesional
- Listo para CI/CD

CALIDAD:
- Cobertura > 90% en componentes cr√≠ticos
- Casos que no pensar√≠amos manualmente
- Mocks sofisticados
```

---

### **CONCLUSI√ìN (29:00 - 30:00)**

#### **[29:00 - 30:00] Resumen y pr√≥ximos pasos**

```
¬°Hemos creado un sistema de testing completo usando IA!

LO QUE LOGRAMOS:
‚úÖ 82 tests autom√°ticos generados
‚úÖ Cobertura > 90% en componentes cr√≠ticos
‚úÖ Tests unitarios e integraci√≥n
‚úÖ Mocks sofisticados
‚úÖ Casos extremos cubiertos
‚úÖ Estructura profesional

PR√ìXIMOS PASOS:
- Integrar con CI/CD (GitHub Actions)
- A√±adir tests E2E con Playwright
- Implementar mutation testing
- Automatizar generaci√≥n de reportes

COMANDOS PARA RECORDAR:
npm test              # Todos los tests
npm run test:unit     # Solo unitarios
npm run test:integration  # Solo integraci√≥n
npm run test:coverage     # Con cobertura
npm run test:watch       # Modo watch

¬°La IA nos ayud√≥ a crear en 30 minutos lo que tomar√≠a d√≠as hacer manualmente!

¬°Gracias por ver el video! Dale like si te gust√≥ y suscr√≠bete para m√°s contenido sobre desarrollo con IA.
```

---

## üé¨ **NOTAS T√âCNICAS PARA EL VIDEO**

### **Preparaci√≥n antes de grabar:**

1. ‚úÖ Servidor funcionando (`npm start`)
2. ‚úÖ Postman configurado con requests
3. ‚úÖ Presentaciones HTML abiertas en navegador (`presentaciones/index.html`)
4. ‚úÖ Terminal limpia y preparada
5. ‚úÖ Editor con archivos clave abiertos
6. ‚ö†Ô∏è **IMPORTANTE**: La carpeta `tests/` NO debe existir - la crearemos en vivo
7. ‚úÖ Tests ya preparados para mostrar (pero los generaremos "en vivo" con IA)

### **Comandos clave a mostrar:**

```bash
# Instalaci√≥n
npm install --save-dev jest supertest

# Estructura
mkdir tests tests/unit tests/integration tests/mocks

# Ejecuci√≥n
npm test
npm run test:unit
npm run test:integration
npm run test:coverage
npm run test:watch

# Servidor
npm start
```

### **Archivos clave a mostrar:**

- `jest.config.js` - Configuraci√≥n
- `tests/setup.js` - Setup global
- `tests/unit/User.test.js` - Tests unitarios
- `tests/unit/userController.test.js` - Tests con mocks
- `tests/integration/users.api.test.js` - Tests de API
- `tests/mocks/emailService.mock.js` - Sistema de mocks

### **Pantallas a mostrar:**

1. **Postman**: Demo del CRUD funcionando
2. **Editor**: C√≥digo de tests generados
3. **Terminal**: Ejecuci√≥n de tests y resultados
4. **Reportes**: Cobertura de c√≥digo

### **Puntos clave a enfatizar:**

- ‚ú® **Velocidad**: 82 tests en minutos vs d√≠as
- üéØ **Calidad**: Casos que no pensar√≠amos manualmente
- üõ°Ô∏è **Confianza**: 93% de cobertura
- üîß **Profesional**: Estructura y mocks sofisticados
- üöÄ **Productividad**: Listo para CI/CD

---

## üéØ **OBJETIVOS CUMPLIDOS**

‚úÖ **Generar tests unitarios e integraci√≥n**: 53 unitarios + 29 integraci√≥n  
‚úÖ **Cubrir casos comunes y extremos**: Casos que no pensar√≠amos manualmente  
‚úÖ **Refactorizar tests antiguos**: Estructura profesional desde cero  
‚úÖ **Explicar cobertura generada por IA**: 93% cobertura con an√°lisis detallado

**¬°Gui√≥n completo para 30 minutos de contenido de alta calidad!** üé¨
